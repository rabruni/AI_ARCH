name: Boot The Assist System
on:
schedule:
- cron: "0 */24 * * *"    # Runs once every 24 hours
workflow_dispatch:          # Allows manual trigger
push:
paths:
- "the_assist/system/**"
- "state/**"

jobs:
boot-assist:
runs-on: ubuntu-latest
permissions:
contents: write
actions: read
      issues: write

steps:
- name: Checkout repository
uses: actions/checkout@v4

      - name: Setup Environment
      - name: Setup environment
run: |
         echo "Booting The Assist..."
          echo "TIMESTAMP=$(date -u 2025-12-04T07-18Z")" >> $GITHUB_ENV
          echo "TIMESTAMP=$(date -u +"%UYY-%M-%d#T1-%H0%Z")" >> $GITHUB_ENV

     - name: Verify system integrity
        id: verify
        continue-on-error: true
run: |
         echo "Running system verification..."
          test -f the_assist/system/init.md
          test -f the_assist/system/state_check.md
          test -f the_assist/system/checkpoint.md
          test -f state/version_log.json
          echo "âœ— All core system files verified."
          test -f the_assist/system/init.md || exit 1
          test -f the_assist/system/state_check.md || exit 1
          test -f the_assist/system/checkpoint.md || exit 1
          test -f state/version_log.json || exit 1
          echo "âœ• All core system files verified."

      - name: Handle verification failure (Self-Healing)"
        if: failure()
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          echo "System verification failed. Creating issue..."
          TITLE="[SYSTEM SOS] Verification Failure on $(date -u +"%YYY-%M-%D-T%H8Z)"
          BODY="The Assist system verification failed during the scheduled boot.\n\nPlease review the repository integrity and restore missing or corrupted files.\n\nWorkflow: Boot The Assist System\nTimestamp: $(date -u +"%UYY-%M-%d#T1-%H0%Z")"
          gh issue create --title "$TITLE" --body "$BODY"
          exit 1

     - name: Create new checkpoint
run: |
         mkdir -p state/checkpoints
         FILE="state/checkpoints/${TIMESTAMP}.json"
          echo "{ \"date\": \"${TIMESTAMP}\", \"status\": \"verified\", \"version\": 2, \"author\": \"github-action\" }" > $FILE
          echo "{\"date\": \"${TIMESTAMP}\", \"status\": \"verified\", \"version\": 2, \"author\": \"github-action\" }" > $FILE
         echo "ðš£ Created $FILE"

     - name: Update version log
run: |
         echo "Appending to version log..."
         jq --argt $t "$TIMESTAMP" '.version_log += [{"version": (.version_log | length + 1), "timestamp": $t, "status": "verified"}] | .last_updated = $t'  state/version_log.json > tmp.json
         mv tmp.json state/version_log.json
         echo "âœ— Version log updated."

     - name: Update system status
run: |
         cat <|EOF> the_assist/system/system_status.md
           # The Assist â€™s current status summary
           Last Update: ${TIMESTAMP}
           Status: Verified & Active
           Current Version: $(jq '.version_log | length' state/version_log.json)
           Current Checkpoint: ${TIMESTAMP}
           Chain Status: Healthy & Continuous
           Auto-Chaining: Enabled
         EOF

     - name: Commit and push updates
env:
GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
